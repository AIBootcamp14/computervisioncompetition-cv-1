2025-09-04 17:15:09 | >> 표준 출력 및 오류를 로그 파일로 리디렉션 시작
2025-09-04 17:15:09 | >> Logger started: logs/train/train_20250904-1715_v087-ef727c.log
2025-09-04 17:15:09 | [BOOT] training pipeline started
2025-09-04 17:15:09 | [BOOT] device=cuda
2025-09-04 17:15:09 | [CFG] loaded config from configs/train.yaml
2025-09-04 17:15:09 | [CFG] data section: {'root': '../data', 'train_csv': '../data/raw/train.csv', 'sample_csv': '../data/raw/sample_submission.csv', 'image_dir_train': '../data/raw/train', 'image_dir_test': '../data/raw/test', 'image_ext': '.jpg', 'id_col': 'ID', 'target_col': 'target', 'num_classes': 17, 'folds': 5, 'valid_fold': 'all', 'stratify': True}
2025-09-04 17:15:09 | [CFG] train section: {'img_size': 384, 'batch_size': 64, 'epochs': 10, 'lr': 0.001, 'weight_decay': 0.0, 'optimizer': 'adam', 'scheduler': 'cosine', 'amp': True, 'grad_clip_norm': 1.0, 'label_smoothing': 0.0, 'log_interval': 50}
2025-09-04 17:15:09 | [CFG] model section: {'name': 'efficientnet_b3', 'pretrained': True, 'drop_rate': 0.0, 'drop_path_rate': 0.0, 'pooling': 'avg'}
2025-09-04 17:15:09 | [CFG] output section: {'logs_dir': 'logs/train', 'exp_dir': 'experiments/train', 'snapshots': True}
2025-09-04 17:15:09 | [PATH] OK | train_csv=/home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/data/raw/train.csv | sample_csv=/home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/data/raw/sample_submission.csv | image_dir_train=/home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/data/raw/train
2025-09-04 17:15:09 | [DATA] columns=['ID', 'target'] | required=('ID', 'target')
2025-09-04 17:15:09 | [FOLD] preparing | folds=5 stratify=True
2025-09-04 17:15:09 | [FOLD] distribution={0: 314, 1: 314, 2: 314, 3: 314, 4: 314}
2025-09-04 17:15:09 | [ARTIFACTS] exp_root=experiments/train/20250904/v087
2025-09-04 17:15:09 | [ARTIFACTS] ckpt_dir=experiments/train/20250904/v087/ckpt
2025-09-04 17:15:09 | [ARTIFACTS] metrics_path=experiments/train/20250904/v087/metrics.jsonl
2025-09-04 17:15:09 | [ARTIFACTS] cfg_snapshot=experiments/train/20250904/v087/config.yaml
2025-09-04 17:15:09 | [MODE] valid_fold=all
2025-09-04 17:15:09 | [FOLD 0] >>> start | train=1256 valid=314
2025-09-04 17:15:09 | [DATA] build loaders | img_dir=/home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/data/raw/train | img_size=384 | bs=64
2025-09-04 17:15:09 | [DATA] dataset sizes | train=1256 valid=314
2025-09-04 17:15:10 | [MODEL] name=efficientnet_b3 pretrained=True pooling=avg params(total/trainable)=10722361/10722361
2025-09-04 17:15:10 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:500: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler(enabled=bool(cfg["train"]["amp"]))
2025-09-04 17:15:10 | [OPTIM] optimizer=Adam, lr=0.001, weight_decay=0.0, scheduler=CosineAnnealingLR
2025-09-04 17:15:10 | [FOLD 0][EPOCH 1] ---------- start ----------
2025-09-04 17:15:10 | [EPOCH 1] >>> TRAIN start | steps=20
2025-09-04 17:15:10 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:12 | [EPOCH 1][TRAIN step 1/20] loss=3.45618 lr=0.001000 bs=64
2025-09-04 17:15:17 | [EPOCH 1][TRAIN step 20/20] loss=0.55977 lr=0.001000 bs=40
2025-09-04 17:15:17 | [EPOCH 1] <<< TRAIN end | loss=0.91190 mem=2756MiB
2025-09-04 17:15:17 | [EPOCH 1] >>> VALID start | steps=5
2025-09-04 17:15:18 | [EPOCH 1] <<< VALID end | loss=0.31431 macro_f1=0.87506
2025-09-04 17:15:18 | [FOLD 0][EPOCH 1] metrics={'fold': 0, 'epoch': 1, 'train_loss': 0.911897515415386, 'valid_loss': 0.31431140062535645, 'macro_f1': 0.8750606105393856, 'lr': 0.0009999383162408303, 'time_s': 7.806953430175781, 'mem_MiB': 2756.453125}
2025-09-04 17:15:18 | [FOLD 0][EPOCH 1] NEW_BEST F1=0.87506 -> experiments/train/20250904/v087/ckpt/best_fold0.pth
2025-09-04 17:15:18 | [FOLD 0][EPOCH 1] ----------- end -----------
2025-09-04 17:15:18 | [FOLD 0][EPOCH 2] ---------- start ----------
2025-09-04 17:15:18 | [EPOCH 2] >>> TRAIN start | steps=20
2025-09-04 17:15:18 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:18 | [EPOCH 2][TRAIN step 1/20] loss=0.07729 lr=0.001000 bs=64
2025-09-04 17:15:21 | [EPOCH 2][TRAIN step 20/20] loss=0.29273 lr=0.001000 bs=40
2025-09-04 17:15:21 | [EPOCH 2] <<< TRAIN end | loss=0.18837 mem=2827MiB
2025-09-04 17:15:21 | [EPOCH 2] >>> VALID start | steps=5
2025-09-04 17:15:22 | [EPOCH 2] <<< VALID end | loss=0.46405 macro_f1=0.85378
2025-09-04 17:15:22 | [FOLD 0][EPOCH 2] metrics={'fold': 0, 'epoch': 2, 'train_loss': 0.18837484299756918, 'valid_loss': 0.4640467037820512, 'macro_f1': 0.8537832206053153, 'lr': 0.0009997532801828658, 'time_s': 4.417019605636597, 'mem_MiB': 2826.58203125}
2025-09-04 17:15:22 | [FOLD 0][EPOCH 2] ----------- end -----------
2025-09-04 17:15:22 | [FOLD 0][EPOCH 3] ---------- start ----------
2025-09-04 17:15:22 | [EPOCH 3] >>> TRAIN start | steps=20
2025-09-04 17:15:22 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:23 | [EPOCH 3][TRAIN step 1/20] loss=0.06963 lr=0.001000 bs=64
2025-09-04 17:15:26 | [EPOCH 3][TRAIN step 20/20] loss=0.14697 lr=0.001000 bs=40
2025-09-04 17:15:26 | [EPOCH 3] <<< TRAIN end | loss=0.08266 mem=2827MiB
2025-09-04 17:15:26 | [EPOCH 3] >>> VALID start | steps=5
2025-09-04 17:15:26 | [EPOCH 3] <<< VALID end | loss=0.50462 macro_f1=0.90137
2025-09-04 17:15:26 | [FOLD 0][EPOCH 3] metrics={'fold': 0, 'epoch': 3, 'train_loss': 0.08266142086618265, 'valid_loss': 0.5046205759807757, 'macro_f1': 0.9013722852587529, 'lr': 0.0009994449374809851, 'time_s': 4.219749212265015, 'mem_MiB': 2826.62109375}
2025-09-04 17:15:26 | [FOLD 0][EPOCH 3] NEW_BEST F1=0.90137 -> experiments/train/20250904/v087/ckpt/best_fold0.pth
2025-09-04 17:15:26 | [FOLD 0][EPOCH 3] ----------- end -----------
2025-09-04 17:15:26 | [FOLD 0][EPOCH 4] ---------- start ----------
2025-09-04 17:15:26 | [EPOCH 4] >>> TRAIN start | steps=20
2025-09-04 17:15:27 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:27 | [EPOCH 4][TRAIN step 1/20] loss=0.12918 lr=0.000999 bs=64
2025-09-04 17:15:30 | [EPOCH 4][TRAIN step 20/20] loss=0.15814 lr=0.000999 bs=40
2025-09-04 17:15:30 | [EPOCH 4] <<< TRAIN end | loss=0.08545 mem=2828MiB
2025-09-04 17:15:30 | [EPOCH 4] >>> VALID start | steps=5
2025-09-04 17:15:31 | [EPOCH 4] <<< VALID end | loss=0.31200 macro_f1=0.90673
2025-09-04 17:15:31 | [FOLD 0][EPOCH 4] metrics={'fold': 0, 'epoch': 4, 'train_loss': 0.08545473692523446, 'valid_loss': 0.3120009891546456, 'macro_f1': 0.9067345736227409, 'lr': 0.0009990133642141358, 'time_s': 4.303814172744751, 'mem_MiB': 2827.84765625}
2025-09-04 17:15:31 | [FOLD 0][EPOCH 4] NEW_BEST F1=0.90673 -> experiments/train/20250904/v087/ckpt/best_fold0.pth
2025-09-04 17:15:31 | [FOLD 0][EPOCH 4] ----------- end -----------
2025-09-04 17:15:31 | [FOLD 0][EPOCH 5] ---------- start ----------
2025-09-04 17:15:31 | [EPOCH 5] >>> TRAIN start | steps=20
2025-09-04 17:15:31 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:31 | [EPOCH 5][TRAIN step 1/20] loss=0.06160 lr=0.000999 bs=64
2025-09-04 17:15:34 | [EPOCH 5][TRAIN step 20/20] loss=0.09381 lr=0.000999 bs=40
2025-09-04 17:15:34 | [EPOCH 5] <<< TRAIN end | loss=0.06783 mem=2828MiB
2025-09-04 17:15:34 | [EPOCH 5] >>> VALID start | steps=5
2025-09-04 17:15:35 | [EPOCH 5] <<< VALID end | loss=0.41519 macro_f1=0.90112
2025-09-04 17:15:35 | [FOLD 0][EPOCH 5] metrics={'fold': 0, 'epoch': 5, 'train_loss': 0.06783024136238038, 'valid_loss': 0.41519332928642344, 'macro_f1': 0.9011223319970457, 'lr': 0.000998458666866564, 'time_s': 4.133641481399536, 'mem_MiB': 2827.90234375}
2025-09-04 17:15:35 | [FOLD 0][EPOCH 5] ----------- end -----------
2025-09-04 17:15:35 | [FOLD 0][EPOCH 6] ---------- start ----------
2025-09-04 17:15:35 | [EPOCH 6] >>> TRAIN start | steps=20
2025-09-04 17:15:35 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:35 | [EPOCH 6][TRAIN step 1/20] loss=0.12741 lr=0.000998 bs=64
2025-09-04 17:15:38 | [EPOCH 6][TRAIN step 20/20] loss=0.13858 lr=0.000998 bs=40
2025-09-04 17:15:38 | [EPOCH 6] <<< TRAIN end | loss=0.05758 mem=2828MiB
2025-09-04 17:15:38 | [EPOCH 6] >>> VALID start | steps=5
2025-09-04 17:15:39 | [EPOCH 6] <<< VALID end | loss=0.52329 macro_f1=0.88961
2025-09-04 17:15:39 | [FOLD 0][EPOCH 6] metrics={'fold': 0, 'epoch': 6, 'train_loss': 0.057583093358452915, 'valid_loss': 0.5232943349583133, 'macro_f1': 0.8896148341060032, 'lr': 0.00099778098230154, 'time_s': 4.236618757247925, 'mem_MiB': 2827.90234375}
2025-09-04 17:15:39 | [FOLD 0][EPOCH 6] ----------- end -----------
2025-09-04 17:15:39 | [FOLD 0][EPOCH 7] ---------- start ----------
2025-09-04 17:15:39 | [EPOCH 7] >>> TRAIN start | steps=20
2025-09-04 17:15:40 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:40 | [EPOCH 7][TRAIN step 1/20] loss=0.14496 lr=0.000998 bs=64
2025-09-04 17:15:43 | [EPOCH 7][TRAIN step 20/20] loss=0.07657 lr=0.000998 bs=40
2025-09-04 17:15:43 | [EPOCH 7] <<< TRAIN end | loss=0.06473 mem=2828MiB
2025-09-04 17:15:43 | [EPOCH 7] >>> VALID start | steps=5
2025-09-04 17:15:43 | [EPOCH 7] <<< VALID end | loss=0.36747 macro_f1=0.91548
2025-09-04 17:15:43 | [FOLD 0][EPOCH 7] metrics={'fold': 0, 'epoch': 7, 'train_loss': 0.06473474479784631, 'valid_loss': 0.3674738830441882, 'macro_f1': 0.9154767658502878, 'lr': 0.0009969804777275899, 'time_s': 4.23177695274353, 'mem_MiB': 2828.0546875}
2025-09-04 17:15:43 | [FOLD 0][EPOCH 7] NEW_BEST F1=0.91548 -> experiments/train/20250904/v087/ckpt/best_fold0.pth
2025-09-04 17:15:43 | [FOLD 0][EPOCH 7] ----------- end -----------
2025-09-04 17:15:43 | [FOLD 0][EPOCH 8] ---------- start ----------
2025-09-04 17:15:43 | [EPOCH 8] >>> TRAIN start | steps=20
2025-09-04 17:15:44 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:44 | [EPOCH 8][TRAIN step 1/20] loss=0.08773 lr=0.000997 bs=64
2025-09-04 17:15:47 | [EPOCH 8][TRAIN step 20/20] loss=0.00390 lr=0.000997 bs=40
2025-09-04 17:15:47 | [EPOCH 8] <<< TRAIN end | loss=0.02850 mem=2828MiB
2025-09-04 17:15:47 | [EPOCH 8] >>> VALID start | steps=5
2025-09-04 17:15:50 | [EPOCH 8] <<< VALID end | loss=0.28702 macro_f1=0.94945
2025-09-04 17:15:50 | [FOLD 0][EPOCH 8] metrics={'fold': 0, 'epoch': 8, 'train_loss': 0.028500125663366856, 'valid_loss': 0.2870208313510676, 'macro_f1': 0.9494465924199786, 'lr': 0.000996057350657239, 'time_s': 6.046905994415283, 'mem_MiB': 2828.02734375}
2025-09-04 17:15:50 | [FOLD 0][EPOCH 8] NEW_BEST F1=0.94945 -> experiments/train/20250904/v087/ckpt/best_fold0.pth
2025-09-04 17:15:50 | [FOLD 0][EPOCH 8] ----------- end -----------
2025-09-04 17:15:50 | [FOLD 0][EPOCH 9] ---------- start ----------
2025-09-04 17:15:50 | [EPOCH 9] >>> TRAIN start | steps=20
2025-09-04 17:15:50 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:50 | [EPOCH 9][TRAIN step 1/20] loss=0.00450 lr=0.000996 bs=64
2025-09-04 17:15:53 | [EPOCH 9][TRAIN step 20/20] loss=0.07211 lr=0.000996 bs=40
2025-09-04 17:15:53 | [EPOCH 9] <<< TRAIN end | loss=0.01437 mem=2828MiB
2025-09-04 17:15:53 | [EPOCH 9] >>> VALID start | steps=5
2025-09-04 17:15:54 | [EPOCH 9] <<< VALID end | loss=0.45867 macro_f1=0.92275
2025-09-04 17:15:54 | [FOLD 0][EPOCH 9] metrics={'fold': 0, 'epoch': 9, 'train_loss': 0.014371990777884319, 'valid_loss': 0.4586652429999819, 'macro_f1': 0.9227516650519545, 'lr': 0.0009950118288582787, 'time_s': 4.398573398590088, 'mem_MiB': 2828.05078125}
2025-09-04 17:15:54 | [FOLD 0][EPOCH 9] ----------- end -----------
2025-09-04 17:15:54 | [FOLD 0][EPOCH 10] ---------- start ----------
2025-09-04 17:15:54 | [EPOCH 10] >>> TRAIN start | steps=20
2025-09-04 17:15:54 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:55 | [EPOCH 10][TRAIN step 1/20] loss=0.01828 lr=0.000995 bs=64
2025-09-04 17:15:58 | [EPOCH 10][TRAIN step 20/20] loss=0.04939 lr=0.000995 bs=40
2025-09-04 17:15:58 | [EPOCH 10] <<< TRAIN end | loss=0.05240 mem=2828MiB
2025-09-04 17:15:58 | [EPOCH 10] >>> VALID start | steps=5
2025-09-04 17:15:58 | [EPOCH 10] <<< VALID end | loss=0.32332 macro_f1=0.93424
2025-09-04 17:15:58 | [FOLD 0][EPOCH 10] metrics={'fold': 0, 'epoch': 10, 'train_loss': 0.052404018225753385, 'valid_loss': 0.32332227298408556, 'macro_f1': 0.9342442252745302, 'lr': 0.0009938441702975688, 'time_s': 4.24478006362915, 'mem_MiB': 2828.05859375}
2025-09-04 17:15:58 | [FOLD 0][EPOCH 10] ----------- end -----------
2025-09-04 17:15:58 | [FOLD 0] <<< end | best_f1=0.94945
2025-09-04 17:15:58 | [FOLD 1] >>> start | train=1256 valid=314
2025-09-04 17:15:58 | [DATA] build loaders | img_dir=/home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/data/raw/train | img_size=384 | bs=64
2025-09-04 17:15:58 | [DATA] dataset sizes | train=1256 valid=314
2025-09-04 17:15:59 | [MODEL] name=efficientnet_b3 pretrained=True pooling=avg params(total/trainable)=10722361/10722361
2025-09-04 17:15:59 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:500: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler(enabled=bool(cfg["train"]["amp"]))
2025-09-04 17:15:59 | [OPTIM] optimizer=Adam, lr=0.001, weight_decay=0.0, scheduler=CosineAnnealingLR
2025-09-04 17:15:59 | [FOLD 1][EPOCH 1] ---------- start ----------
2025-09-04 17:15:59 | [EPOCH 1] >>> TRAIN start | steps=20
2025-09-04 17:15:59 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:15:59 | [EPOCH 1][TRAIN step 1/20] loss=3.74093 lr=0.001000 bs=64
2025-09-04 17:16:02 | [EPOCH 1][TRAIN step 20/20] loss=0.27774 lr=0.001000 bs=40
2025-09-04 17:16:02 | [EPOCH 1] <<< TRAIN end | loss=0.96753 mem=2825MiB
2025-09-04 17:16:02 | [EPOCH 1] >>> VALID start | steps=5
2025-09-04 17:16:03 | [EPOCH 1] <<< VALID end | loss=0.39210 macro_f1=0.84135
2025-09-04 17:16:03 | [FOLD 1][EPOCH 1] metrics={'fold': 1, 'epoch': 1, 'train_loss': 0.9675338636538026, 'valid_loss': 0.39210177758696735, 'macro_f1': 0.8413514131092907, 'lr': 0.0009999383162408303, 'time_s': 4.1993513107299805, 'mem_MiB': 2825.33203125}
2025-09-04 17:16:03 | [FOLD 1][EPOCH 1] NEW_BEST F1=0.84135 -> experiments/train/20250904/v087/ckpt/best_fold1.pth
2025-09-04 17:16:03 | [FOLD 1][EPOCH 1] ----------- end -----------
2025-09-04 17:16:03 | [FOLD 1][EPOCH 2] ---------- start ----------
2025-09-04 17:16:03 | [EPOCH 2] >>> TRAIN start | steps=20
2025-09-04 17:16:03 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:03 | [EPOCH 2][TRAIN step 1/20] loss=0.16090 lr=0.001000 bs=64
2025-09-04 17:16:06 | [EPOCH 2][TRAIN step 20/20] loss=0.40670 lr=0.001000 bs=40
2025-09-04 17:16:06 | [EPOCH 2] <<< TRAIN end | loss=0.20387 mem=2829MiB
2025-09-04 17:16:06 | [EPOCH 2] >>> VALID start | steps=5
2025-09-04 17:16:07 | [EPOCH 2] <<< VALID end | loss=0.49139 macro_f1=0.88787
2025-09-04 17:16:07 | [FOLD 1][EPOCH 2] metrics={'fold': 1, 'epoch': 2, 'train_loss': 0.20386808579135093, 'valid_loss': 0.4913904589072914, 'macro_f1': 0.8878669524489958, 'lr': 0.0009997532801828658, 'time_s': 4.188702344894409, 'mem_MiB': 2829.125}
2025-09-04 17:16:07 | [FOLD 1][EPOCH 2] NEW_BEST F1=0.88787 -> experiments/train/20250904/v087/ckpt/best_fold1.pth
2025-09-04 17:16:07 | [FOLD 1][EPOCH 2] ----------- end -----------
2025-09-04 17:16:07 | [FOLD 1][EPOCH 3] ---------- start ----------
2025-09-04 17:16:07 | [EPOCH 3] >>> TRAIN start | steps=20
2025-09-04 17:16:07 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:08 | [EPOCH 3][TRAIN step 1/20] loss=0.22240 lr=0.001000 bs=64
2025-09-04 17:16:11 | [EPOCH 3][TRAIN step 20/20] loss=0.20580 lr=0.001000 bs=40
2025-09-04 17:16:11 | [EPOCH 3] <<< TRAIN end | loss=0.12709 mem=2829MiB
2025-09-04 17:16:11 | [EPOCH 3] >>> VALID start | steps=5
2025-09-04 17:16:11 | [EPOCH 3] <<< VALID end | loss=0.40254 macro_f1=0.86311
2025-09-04 17:16:11 | [FOLD 1][EPOCH 3] metrics={'fold': 1, 'epoch': 3, 'train_loss': 0.12709392967877114, 'valid_loss': 0.4025376091717155, 'macro_f1': 0.8631100000427193, 'lr': 0.0009994449374809851, 'time_s': 4.2102274894714355, 'mem_MiB': 2829.1875}
2025-09-04 17:16:11 | [FOLD 1][EPOCH 3] ----------- end -----------
2025-09-04 17:16:11 | [FOLD 1][EPOCH 4] ---------- start ----------
2025-09-04 17:16:11 | [EPOCH 4] >>> TRAIN start | steps=20
2025-09-04 17:16:12 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:12 | [EPOCH 4][TRAIN step 1/20] loss=0.04469 lr=0.000999 bs=64
2025-09-04 17:16:15 | [EPOCH 4][TRAIN step 20/20] loss=0.00424 lr=0.000999 bs=40
2025-09-04 17:16:15 | [EPOCH 4] <<< TRAIN end | loss=0.06243 mem=2829MiB
2025-09-04 17:16:15 | [EPOCH 4] >>> VALID start | steps=5
2025-09-04 17:16:16 | [EPOCH 4] <<< VALID end | loss=0.28969 macro_f1=0.90025
2025-09-04 17:16:16 | [FOLD 1][EPOCH 4] metrics={'fold': 1, 'epoch': 4, 'train_loss': 0.06242624637641155, 'valid_loss': 0.2896934014027286, 'macro_f1': 0.9002497650334285, 'lr': 0.0009990133642141358, 'time_s': 4.284672498703003, 'mem_MiB': 2829.1953125}
2025-09-04 17:16:16 | [FOLD 1][EPOCH 4] NEW_BEST F1=0.90025 -> experiments/train/20250904/v087/ckpt/best_fold1.pth
2025-09-04 17:16:16 | [FOLD 1][EPOCH 4] ----------- end -----------
2025-09-04 17:16:16 | [FOLD 1][EPOCH 5] ---------- start ----------
2025-09-04 17:16:16 | [EPOCH 5] >>> TRAIN start | steps=20
2025-09-04 17:16:16 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:16 | [EPOCH 5][TRAIN step 1/20] loss=0.00299 lr=0.000999 bs=64
2025-09-04 17:16:19 | [EPOCH 5][TRAIN step 20/20] loss=0.39837 lr=0.000999 bs=40
2025-09-04 17:16:19 | [EPOCH 5] <<< TRAIN end | loss=0.03872 mem=2829MiB
2025-09-04 17:16:19 | [EPOCH 5] >>> VALID start | steps=5
2025-09-04 17:16:20 | [EPOCH 5] <<< VALID end | loss=0.42447 macro_f1=0.90699
2025-09-04 17:16:20 | [FOLD 1][EPOCH 5] metrics={'fold': 1, 'epoch': 5, 'train_loss': 0.038724939060059325, 'valid_loss': 0.4244726353390202, 'macro_f1': 0.9069938803763634, 'lr': 0.000998458666866564, 'time_s': 4.3657386302948, 'mem_MiB': 2829.25}
2025-09-04 17:16:20 | [FOLD 1][EPOCH 5] NEW_BEST F1=0.90699 -> experiments/train/20250904/v087/ckpt/best_fold1.pth
2025-09-04 17:16:20 | [FOLD 1][EPOCH 5] ----------- end -----------
2025-09-04 17:16:20 | [FOLD 1][EPOCH 6] ---------- start ----------
2025-09-04 17:16:20 | [EPOCH 6] >>> TRAIN start | steps=20
2025-09-04 17:16:20 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:21 | [EPOCH 6][TRAIN step 1/20] loss=0.01435 lr=0.000998 bs=64
2025-09-04 17:16:25 | [EPOCH 6][TRAIN step 20/20] loss=0.07291 lr=0.000998 bs=40
2025-09-04 17:16:25 | [EPOCH 6] <<< TRAIN end | loss=0.08350 mem=2829MiB
2025-09-04 17:16:25 | [EPOCH 6] >>> VALID start | steps=5
2025-09-04 17:16:26 | [EPOCH 6] <<< VALID end | loss=0.44020 macro_f1=0.87512
2025-09-04 17:16:26 | [FOLD 1][EPOCH 6] metrics={'fold': 1, 'epoch': 6, 'train_loss': 0.08350362443620232, 'valid_loss': 0.44019768296912976, 'macro_f1': 0.8751200598318268, 'lr': 0.00099778098230154, 'time_s': 6.175596475601196, 'mem_MiB': 2829.36328125}
2025-09-04 17:16:26 | [FOLD 1][EPOCH 6] ----------- end -----------
2025-09-04 17:16:26 | [FOLD 1][EPOCH 7] ---------- start ----------
2025-09-04 17:16:26 | [EPOCH 7] >>> TRAIN start | steps=20
2025-09-04 17:16:27 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:27 | [EPOCH 7][TRAIN step 1/20] loss=0.01983 lr=0.000998 bs=64
2025-09-04 17:16:30 | [EPOCH 7][TRAIN step 20/20] loss=0.07314 lr=0.000998 bs=40
2025-09-04 17:16:30 | [EPOCH 7] <<< TRAIN end | loss=0.09063 mem=2829MiB
2025-09-04 17:16:30 | [EPOCH 7] >>> VALID start | steps=5
2025-09-04 17:16:31 | [EPOCH 7] <<< VALID end | loss=0.35344 macro_f1=0.92054
2025-09-04 17:16:31 | [FOLD 1][EPOCH 7] metrics={'fold': 1, 'epoch': 7, 'train_loss': 0.09062954797676415, 'valid_loss': 0.35343837334661726, 'macro_f1': 0.9205429119207265, 'lr': 0.0009969804777275899, 'time_s': 4.428493499755859, 'mem_MiB': 2829.375}
2025-09-04 17:16:31 | [FOLD 1][EPOCH 7] NEW_BEST F1=0.92054 -> experiments/train/20250904/v087/ckpt/best_fold1.pth
2025-09-04 17:16:31 | [FOLD 1][EPOCH 7] ----------- end -----------
2025-09-04 17:16:31 | [FOLD 1][EPOCH 8] ---------- start ----------
2025-09-04 17:16:31 | [EPOCH 8] >>> TRAIN start | steps=20
2025-09-04 17:16:31 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:31 | [EPOCH 8][TRAIN step 1/20] loss=0.01473 lr=0.000997 bs=64
2025-09-04 17:16:34 | [EPOCH 8][TRAIN step 20/20] loss=0.08801 lr=0.000997 bs=40
2025-09-04 17:16:34 | [EPOCH 8] <<< TRAIN end | loss=0.05835 mem=2829MiB
2025-09-04 17:16:34 | [EPOCH 8] >>> VALID start | steps=5
2025-09-04 17:16:35 | [EPOCH 8] <<< VALID end | loss=0.56242 macro_f1=0.87401
2025-09-04 17:16:35 | [FOLD 1][EPOCH 8] metrics={'fold': 1, 'epoch': 8, 'train_loss': 0.058346382277027056, 'valid_loss': 0.5624237861602929, 'macro_f1': 0.8740054535108174, 'lr': 0.000996057350657239, 'time_s': 4.218950271606445, 'mem_MiB': 2829.3359375}
2025-09-04 17:16:35 | [FOLD 1][EPOCH 8] ----------- end -----------
2025-09-04 17:16:35 | [FOLD 1][EPOCH 9] ---------- start ----------
2025-09-04 17:16:35 | [EPOCH 9] >>> TRAIN start | steps=20
2025-09-04 17:16:35 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:35 | [EPOCH 9][TRAIN step 1/20] loss=0.03708 lr=0.000996 bs=64
2025-09-04 17:16:38 | [EPOCH 9][TRAIN step 20/20] loss=0.01279 lr=0.000996 bs=40
2025-09-04 17:16:38 | [EPOCH 9] <<< TRAIN end | loss=0.04074 mem=2829MiB
2025-09-04 17:16:38 | [EPOCH 9] >>> VALID start | steps=5
2025-09-04 17:16:39 | [EPOCH 9] <<< VALID end | loss=0.34996 macro_f1=0.91936
2025-09-04 17:16:39 | [FOLD 1][EPOCH 9] metrics={'fold': 1, 'epoch': 9, 'train_loss': 0.0407420915972655, 'valid_loss': 0.3499624362796735, 'macro_f1': 0.9193555991121914, 'lr': 0.0009950118288582787, 'time_s': 4.268053293228149, 'mem_MiB': 2829.234375}
2025-09-04 17:16:39 | [FOLD 1][EPOCH 9] ----------- end -----------
2025-09-04 17:16:39 | [FOLD 1][EPOCH 10] ---------- start ----------
2025-09-04 17:16:39 | [EPOCH 10] >>> TRAIN start | steps=20
2025-09-04 17:16:40 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:40 | [EPOCH 10][TRAIN step 1/20] loss=0.00097 lr=0.000995 bs=64
2025-09-04 17:16:43 | [EPOCH 10][TRAIN step 20/20] loss=0.07975 lr=0.000995 bs=40
2025-09-04 17:16:43 | [EPOCH 10] <<< TRAIN end | loss=0.02278 mem=2829MiB
2025-09-04 17:16:43 | [EPOCH 10] >>> VALID start | steps=5
2025-09-04 17:16:44 | [EPOCH 10] <<< VALID end | loss=0.43318 macro_f1=0.92423
2025-09-04 17:16:44 | [FOLD 1][EPOCH 10] metrics={'fold': 1, 'epoch': 10, 'train_loss': 0.022779259806985308, 'valid_loss': 0.4331752357968859, 'macro_f1': 0.9242294482341138, 'lr': 0.0009938441702975688, 'time_s': 4.395510196685791, 'mem_MiB': 2829.26171875}
2025-09-04 17:16:44 | [FOLD 1][EPOCH 10] NEW_BEST F1=0.92423 -> experiments/train/20250904/v087/ckpt/best_fold1.pth
2025-09-04 17:16:44 | [FOLD 1][EPOCH 10] ----------- end -----------
2025-09-04 17:16:44 | [FOLD 1] <<< end | best_f1=0.92423
2025-09-04 17:16:44 | [FOLD 2] >>> start | train=1256 valid=314
2025-09-04 17:16:44 | [DATA] build loaders | img_dir=/home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/data/raw/train | img_size=384 | bs=64
2025-09-04 17:16:44 | [DATA] dataset sizes | train=1256 valid=314
2025-09-04 17:16:44 | [MODEL] name=efficientnet_b3 pretrained=True pooling=avg params(total/trainable)=10722361/10722361
2025-09-04 17:16:44 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:500: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler(enabled=bool(cfg["train"]["amp"]))
2025-09-04 17:16:44 | [OPTIM] optimizer=Adam, lr=0.001, weight_decay=0.0, scheduler=CosineAnnealingLR
2025-09-04 17:16:44 | [FOLD 2][EPOCH 1] ---------- start ----------
2025-09-04 17:16:44 | [EPOCH 1] >>> TRAIN start | steps=20
2025-09-04 17:16:44 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:45 | [EPOCH 1][TRAIN step 1/20] loss=3.34791 lr=0.001000 bs=64
2025-09-04 17:16:48 | [EPOCH 1][TRAIN step 20/20] loss=0.54955 lr=0.001000 bs=40
2025-09-04 17:16:48 | [EPOCH 1] <<< TRAIN end | loss=0.89301 mem=2826MiB
2025-09-04 17:16:48 | [EPOCH 1] >>> VALID start | steps=5
2025-09-04 17:16:49 | [EPOCH 1] <<< VALID end | loss=0.45625 macro_f1=0.82928
2025-09-04 17:16:49 | [FOLD 2][EPOCH 1] metrics={'fold': 2, 'epoch': 1, 'train_loss': 0.893006413225915, 'valid_loss': 0.45624929040100926, 'macro_f1': 0.8292798957261001, 'lr': 0.0009999383162408303, 'time_s': 4.559793472290039, 'mem_MiB': 2825.59765625}
2025-09-04 17:16:49 | [FOLD 2][EPOCH 1] NEW_BEST F1=0.82928 -> experiments/train/20250904/v087/ckpt/best_fold2.pth
2025-09-04 17:16:49 | [FOLD 2][EPOCH 1] ----------- end -----------
2025-09-04 17:16:49 | [FOLD 2][EPOCH 2] ---------- start ----------
2025-09-04 17:16:49 | [EPOCH 2] >>> TRAIN start | steps=20
2025-09-04 17:16:49 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:49 | [EPOCH 2][TRAIN step 1/20] loss=0.26694 lr=0.001000 bs=64
2025-09-04 17:16:52 | [EPOCH 2][TRAIN step 20/20] loss=0.17935 lr=0.001000 bs=40
2025-09-04 17:16:52 | [EPOCH 2] <<< TRAIN end | loss=0.22441 mem=2830MiB
2025-09-04 17:16:52 | [EPOCH 2] >>> VALID start | steps=5
2025-09-04 17:16:53 | [EPOCH 2] <<< VALID end | loss=0.28491 macro_f1=0.91268
2025-09-04 17:16:53 | [FOLD 2][EPOCH 2] metrics={'fold': 2, 'epoch': 2, 'train_loss': 0.22441032794630453, 'valid_loss': 0.2849123134354877, 'macro_f1': 0.9126780926467646, 'lr': 0.0009997532801828658, 'time_s': 4.269307374954224, 'mem_MiB': 2829.6328125}
2025-09-04 17:16:53 | [FOLD 2][EPOCH 2] NEW_BEST F1=0.91268 -> experiments/train/20250904/v087/ckpt/best_fold2.pth
2025-09-04 17:16:53 | [FOLD 2][EPOCH 2] ----------- end -----------
2025-09-04 17:16:53 | [FOLD 2][EPOCH 3] ---------- start ----------
2025-09-04 17:16:53 | [EPOCH 3] >>> TRAIN start | steps=20
2025-09-04 17:16:53 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:16:53 | [EPOCH 3][TRAIN step 1/20] loss=0.05922 lr=0.001000 bs=64
2025-09-04 17:16:58 | [EPOCH 3][TRAIN step 20/20] loss=0.10108 lr=0.001000 bs=40
2025-09-04 17:16:58 | [EPOCH 3] <<< TRAIN end | loss=0.11895 mem=2830MiB
2025-09-04 17:16:58 | [EPOCH 3] >>> VALID start | steps=5
2025-09-04 17:16:59 | [EPOCH 3] <<< VALID end | loss=0.26770 macro_f1=0.87949
2025-09-04 17:16:59 | [FOLD 2][EPOCH 3] metrics={'fold': 2, 'epoch': 3, 'train_loss': 0.11895342835575153, 'valid_loss': 0.2677005058640887, 'macro_f1': 0.8794906403158779, 'lr': 0.0009994449374809851, 'time_s': 6.03980565071106, 'mem_MiB': 2829.65625}
2025-09-04 17:16:59 | [FOLD 2][EPOCH 3] ----------- end -----------
2025-09-04 17:16:59 | [FOLD 2][EPOCH 4] ---------- start ----------
2025-09-04 17:16:59 | [EPOCH 4] >>> TRAIN start | steps=20
2025-09-04 17:16:59 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:00 | [EPOCH 4][TRAIN step 1/20] loss=0.04999 lr=0.000999 bs=64
2025-09-04 17:17:03 | [EPOCH 4][TRAIN step 20/20] loss=0.10717 lr=0.000999 bs=40
2025-09-04 17:17:03 | [EPOCH 4] <<< TRAIN end | loss=0.07119 mem=2830MiB
2025-09-04 17:17:03 | [EPOCH 4] >>> VALID start | steps=5
2025-09-04 17:17:03 | [EPOCH 4] <<< VALID end | loss=0.51472 macro_f1=0.90871
2025-09-04 17:17:03 | [FOLD 2][EPOCH 4] metrics={'fold': 2, 'epoch': 4, 'train_loss': 0.0711902334906493, 'valid_loss': 0.5147161965916871, 'macro_f1': 0.9087097275416673, 'lr': 0.0009990133642141358, 'time_s': 4.327260971069336, 'mem_MiB': 2829.6484375}
2025-09-04 17:17:03 | [FOLD 2][EPOCH 4] ----------- end -----------
2025-09-04 17:17:03 | [FOLD 2][EPOCH 5] ---------- start ----------
2025-09-04 17:17:03 | [EPOCH 5] >>> TRAIN start | steps=20
2025-09-04 17:17:04 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:04 | [EPOCH 5][TRAIN step 1/20] loss=0.01216 lr=0.000999 bs=64
2025-09-04 17:17:07 | [EPOCH 5][TRAIN step 20/20] loss=0.03254 lr=0.000999 bs=40
2025-09-04 17:17:07 | [EPOCH 5] <<< TRAIN end | loss=0.06872 mem=2830MiB
2025-09-04 17:17:07 | [EPOCH 5] >>> VALID start | steps=5
2025-09-04 17:17:08 | [EPOCH 5] <<< VALID end | loss=0.30782 macro_f1=0.89638
2025-09-04 17:17:08 | [FOLD 2][EPOCH 5] metrics={'fold': 2, 'epoch': 5, 'train_loss': 0.0687227311075493, 'valid_loss': 0.3078238836898925, 'macro_f1': 0.8963824223407488, 'lr': 0.000998458666866564, 'time_s': 4.257350206375122, 'mem_MiB': 2829.7578125}
2025-09-04 17:17:08 | [FOLD 2][EPOCH 5] ----------- end -----------
2025-09-04 17:17:08 | [FOLD 2][EPOCH 6] ---------- start ----------
2025-09-04 17:17:08 | [EPOCH 6] >>> TRAIN start | steps=20
2025-09-04 17:17:08 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:08 | [EPOCH 6][TRAIN step 1/20] loss=0.00222 lr=0.000998 bs=64
2025-09-04 17:17:11 | [EPOCH 6][TRAIN step 20/20] loss=0.01032 lr=0.000998 bs=40
2025-09-04 17:17:11 | [EPOCH 6] <<< TRAIN end | loss=0.04864 mem=2830MiB
2025-09-04 17:17:11 | [EPOCH 6] >>> VALID start | steps=5
2025-09-04 17:17:12 | [EPOCH 6] <<< VALID end | loss=0.29773 macro_f1=0.91494
2025-09-04 17:17:12 | [FOLD 2][EPOCH 6] metrics={'fold': 2, 'epoch': 6, 'train_loss': 0.04864174062326835, 'valid_loss': 0.2977281400732174, 'macro_f1': 0.9149411826297396, 'lr': 0.00099778098230154, 'time_s': 4.247737646102905, 'mem_MiB': 2829.91796875}
2025-09-04 17:17:12 | [FOLD 2][EPOCH 6] NEW_BEST F1=0.91494 -> experiments/train/20250904/v087/ckpt/best_fold2.pth
2025-09-04 17:17:12 | [FOLD 2][EPOCH 6] ----------- end -----------
2025-09-04 17:17:12 | [FOLD 2][EPOCH 7] ---------- start ----------
2025-09-04 17:17:12 | [EPOCH 7] >>> TRAIN start | steps=20
2025-09-04 17:17:12 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:12 | [EPOCH 7][TRAIN step 1/20] loss=0.01905 lr=0.000998 bs=64
2025-09-04 17:17:15 | [EPOCH 7][TRAIN step 20/20] loss=0.01073 lr=0.000998 bs=40
2025-09-04 17:17:15 | [EPOCH 7] <<< TRAIN end | loss=0.05809 mem=2830MiB
2025-09-04 17:17:15 | [EPOCH 7] >>> VALID start | steps=5
2025-09-04 17:17:16 | [EPOCH 7] <<< VALID end | loss=0.38757 macro_f1=0.92100
2025-09-04 17:17:16 | [FOLD 2][EPOCH 7] metrics={'fold': 2, 'epoch': 7, 'train_loss': 0.058093271069940486, 'valid_loss': 0.38757311652420434, 'macro_f1': 0.9210020940995638, 'lr': 0.0009969804777275899, 'time_s': 4.276231527328491, 'mem_MiB': 2830.0546875}
2025-09-04 17:17:16 | [FOLD 2][EPOCH 7] NEW_BEST F1=0.92100 -> experiments/train/20250904/v087/ckpt/best_fold2.pth
2025-09-04 17:17:16 | [FOLD 2][EPOCH 7] ----------- end -----------
2025-09-04 17:17:16 | [FOLD 2][EPOCH 8] ---------- start ----------
2025-09-04 17:17:16 | [EPOCH 8] >>> TRAIN start | steps=20
2025-09-04 17:17:17 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:17 | [EPOCH 8][TRAIN step 1/20] loss=0.02464 lr=0.000997 bs=64
2025-09-04 17:17:20 | [EPOCH 8][TRAIN step 20/20] loss=0.01185 lr=0.000997 bs=40
2025-09-04 17:17:20 | [EPOCH 8] <<< TRAIN end | loss=0.04295 mem=2830MiB
2025-09-04 17:17:20 | [EPOCH 8] >>> VALID start | steps=5
2025-09-04 17:17:21 | [EPOCH 8] <<< VALID end | loss=0.30852 macro_f1=0.90837
2025-09-04 17:17:21 | [FOLD 2][EPOCH 8] metrics={'fold': 2, 'epoch': 8, 'train_loss': 0.04294818753649475, 'valid_loss': 0.308522899059733, 'macro_f1': 0.9083688010560742, 'lr': 0.000996057350657239, 'time_s': 4.352641344070435, 'mem_MiB': 2830.015625}
2025-09-04 17:17:21 | [FOLD 2][EPOCH 8] ----------- end -----------
2025-09-04 17:17:21 | [FOLD 2][EPOCH 9] ---------- start ----------
2025-09-04 17:17:21 | [EPOCH 9] >>> TRAIN start | steps=20
2025-09-04 17:17:21 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:21 | [EPOCH 9][TRAIN step 1/20] loss=0.00186 lr=0.000996 bs=64
2025-09-04 17:17:24 | [EPOCH 9][TRAIN step 20/20] loss=0.25816 lr=0.000996 bs=40
2025-09-04 17:17:24 | [EPOCH 9] <<< TRAIN end | loss=0.03773 mem=2830MiB
2025-09-04 17:17:24 | [EPOCH 9] >>> VALID start | steps=5
2025-09-04 17:17:25 | [EPOCH 9] <<< VALID end | loss=0.45218 macro_f1=0.90919
2025-09-04 17:17:25 | [FOLD 2][EPOCH 9] metrics={'fold': 2, 'epoch': 9, 'train_loss': 0.03772953361462636, 'valid_loss': 0.45218499166191006, 'macro_f1': 0.9091913833331312, 'lr': 0.0009950118288582787, 'time_s': 4.469158172607422, 'mem_MiB': 2830.04296875}
2025-09-04 17:17:25 | [FOLD 2][EPOCH 9] ----------- end -----------
2025-09-04 17:17:25 | [FOLD 2][EPOCH 10] ---------- start ----------
2025-09-04 17:17:25 | [EPOCH 10] >>> TRAIN start | steps=20
2025-09-04 17:17:25 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:26 | [EPOCH 10][TRAIN step 1/20] loss=0.00121 lr=0.000995 bs=64
2025-09-04 17:17:29 | [EPOCH 10][TRAIN step 20/20] loss=0.35413 lr=0.000995 bs=40
2025-09-04 17:17:29 | [EPOCH 10] <<< TRAIN end | loss=0.03059 mem=2830MiB
2025-09-04 17:17:29 | [EPOCH 10] >>> VALID start | steps=5
2025-09-04 17:17:29 | [EPOCH 10] <<< VALID end | loss=0.65034 macro_f1=0.90896
2025-09-04 17:17:29 | [FOLD 2][EPOCH 10] metrics={'fold': 2, 'epoch': 10, 'train_loss': 0.030590291805328077, 'valid_loss': 0.6503421772437491, 'macro_f1': 0.9089557149286817, 'lr': 0.0009938441702975688, 'time_s': 4.326305389404297, 'mem_MiB': 2830.01953125}
2025-09-04 17:17:29 | [FOLD 2][EPOCH 10] ----------- end -----------
2025-09-04 17:17:29 | [FOLD 2] <<< end | best_f1=0.92100
2025-09-04 17:17:29 | [FOLD 3] >>> start | train=1256 valid=314
2025-09-04 17:17:29 | [DATA] build loaders | img_dir=/home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/data/raw/train | img_size=384 | bs=64
2025-09-04 17:17:29 | [DATA] dataset sizes | train=1256 valid=314
2025-09-04 17:17:32 | [MODEL] name=efficientnet_b3 pretrained=True pooling=avg params(total/trainable)=10722361/10722361
2025-09-04 17:17:32 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:500: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler(enabled=bool(cfg["train"]["amp"]))
2025-09-04 17:17:32 | [OPTIM] optimizer=Adam, lr=0.001, weight_decay=0.0, scheduler=CosineAnnealingLR
2025-09-04 17:17:32 | [FOLD 3][EPOCH 1] ---------- start ----------
2025-09-04 17:17:32 | [EPOCH 1] >>> TRAIN start | steps=20
2025-09-04 17:17:32 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:32 | [EPOCH 1][TRAIN step 1/20] loss=3.89567 lr=0.001000 bs=64
2025-09-04 17:17:35 | [EPOCH 1][TRAIN step 20/20] loss=0.47060 lr=0.001000 bs=40
2025-09-04 17:17:35 | [EPOCH 1] <<< TRAIN end | loss=0.89912 mem=2826MiB
2025-09-04 17:17:35 | [EPOCH 1] >>> VALID start | steps=5
2025-09-04 17:17:36 | [EPOCH 1] <<< VALID end | loss=0.24209 macro_f1=0.89913
2025-09-04 17:17:36 | [FOLD 3][EPOCH 1] metrics={'fold': 3, 'epoch': 1, 'train_loss': 0.8991213135278908, 'valid_loss': 0.24208545760743938, 'macro_f1': 0.8991336306065854, 'lr': 0.0009999383162408303, 'time_s': 4.5763490200042725, 'mem_MiB': 2826.0703125}
2025-09-04 17:17:36 | [FOLD 3][EPOCH 1] NEW_BEST F1=0.89913 -> experiments/train/20250904/v087/ckpt/best_fold3.pth
2025-09-04 17:17:36 | [FOLD 3][EPOCH 1] ----------- end -----------
2025-09-04 17:17:36 | [FOLD 3][EPOCH 2] ---------- start ----------
2025-09-04 17:17:36 | [EPOCH 2] >>> TRAIN start | steps=20
2025-09-04 17:17:37 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:37 | [EPOCH 2][TRAIN step 1/20] loss=0.20809 lr=0.001000 bs=64
2025-09-04 17:17:40 | [EPOCH 2][TRAIN step 20/20] loss=0.49573 lr=0.001000 bs=40
2025-09-04 17:17:40 | [EPOCH 2] <<< TRAIN end | loss=0.22455 mem=2830MiB
2025-09-04 17:17:40 | [EPOCH 2] >>> VALID start | steps=5
2025-09-04 17:17:40 | [EPOCH 2] <<< VALID end | loss=0.38342 macro_f1=0.87609
2025-09-04 17:17:40 | [FOLD 3][EPOCH 2] metrics={'fold': 3, 'epoch': 2, 'train_loss': 0.22455225495775794, 'valid_loss': 0.3834212306578448, 'macro_f1': 0.8760893267442071, 'lr': 0.0009997532801828658, 'time_s': 4.238653659820557, 'mem_MiB': 2830.12890625}
2025-09-04 17:17:40 | [FOLD 3][EPOCH 2] ----------- end -----------
2025-09-04 17:17:40 | [FOLD 3][EPOCH 3] ---------- start ----------
2025-09-04 17:17:41 | [EPOCH 3] >>> TRAIN start | steps=20
2025-09-04 17:17:41 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:41 | [EPOCH 3][TRAIN step 1/20] loss=0.03681 lr=0.001000 bs=64
2025-09-04 17:17:44 | [EPOCH 3][TRAIN step 20/20] loss=0.04854 lr=0.001000 bs=40
2025-09-04 17:17:44 | [EPOCH 3] <<< TRAIN end | loss=0.09946 mem=2830MiB
2025-09-04 17:17:44 | [EPOCH 3] >>> VALID start | steps=5
2025-09-04 17:17:45 | [EPOCH 3] <<< VALID end | loss=0.37445 macro_f1=0.89928
2025-09-04 17:17:45 | [FOLD 3][EPOCH 3] metrics={'fold': 3, 'epoch': 3, 'train_loss': 0.09946170026899144, 'valid_loss': 0.374454075933262, 'macro_f1': 0.8992793142284519, 'lr': 0.0009994449374809851, 'time_s': 4.0950305461883545, 'mem_MiB': 2830.09765625}
2025-09-04 17:17:45 | [FOLD 3][EPOCH 3] NEW_BEST F1=0.89928 -> experiments/train/20250904/v087/ckpt/best_fold3.pth
2025-09-04 17:17:45 | [FOLD 3][EPOCH 3] ----------- end -----------
2025-09-04 17:17:45 | [FOLD 3][EPOCH 4] ---------- start ----------
2025-09-04 17:17:45 | [EPOCH 4] >>> TRAIN start | steps=20
2025-09-04 17:17:45 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:45 | [EPOCH 4][TRAIN step 1/20] loss=0.03878 lr=0.000999 bs=64
2025-09-04 17:17:48 | [EPOCH 4][TRAIN step 20/20] loss=0.04138 lr=0.000999 bs=40
2025-09-04 17:17:48 | [EPOCH 4] <<< TRAIN end | loss=0.09483 mem=2830MiB
2025-09-04 17:17:48 | [EPOCH 4] >>> VALID start | steps=5
2025-09-04 17:17:49 | [EPOCH 4] <<< VALID end | loss=0.61151 macro_f1=0.85436
2025-09-04 17:17:49 | [FOLD 3][EPOCH 4] metrics={'fold': 3, 'epoch': 4, 'train_loss': 0.09483319357227368, 'valid_loss': 0.6115086648114927, 'macro_f1': 0.8543554858672877, 'lr': 0.0009990133642141358, 'time_s': 4.229528188705444, 'mem_MiB': 2830.12890625}
2025-09-04 17:17:49 | [FOLD 3][EPOCH 4] ----------- end -----------
2025-09-04 17:17:49 | [FOLD 3][EPOCH 5] ---------- start ----------
2025-09-04 17:17:49 | [EPOCH 5] >>> TRAIN start | steps=20
2025-09-04 17:17:49 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:49 | [EPOCH 5][TRAIN step 1/20] loss=0.08544 lr=0.000999 bs=64
2025-09-04 17:17:52 | [EPOCH 5][TRAIN step 20/20] loss=0.02755 lr=0.000999 bs=40
2025-09-04 17:17:52 | [EPOCH 5] <<< TRAIN end | loss=0.04940 mem=2830MiB
2025-09-04 17:17:52 | [EPOCH 5] >>> VALID start | steps=5
2025-09-04 17:17:53 | [EPOCH 5] <<< VALID end | loss=0.31603 macro_f1=0.90857
2025-09-04 17:17:53 | [FOLD 3][EPOCH 5] metrics={'fold': 3, 'epoch': 5, 'train_loss': 0.049401115732872564, 'valid_loss': 0.3160337882626588, 'macro_f1': 0.9085670328553971, 'lr': 0.000998458666866564, 'time_s': 4.267441511154175, 'mem_MiB': 2830.1171875}
2025-09-04 17:17:53 | [FOLD 3][EPOCH 5] NEW_BEST F1=0.90857 -> experiments/train/20250904/v087/ckpt/best_fold3.pth
2025-09-04 17:17:53 | [FOLD 3][EPOCH 5] ----------- end -----------
2025-09-04 17:17:53 | [FOLD 3][EPOCH 6] ---------- start ----------
2025-09-04 17:17:53 | [EPOCH 6] >>> TRAIN start | steps=20
2025-09-04 17:17:54 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:54 | [EPOCH 6][TRAIN step 1/20] loss=0.01242 lr=0.000998 bs=64
2025-09-04 17:17:57 | [EPOCH 6][TRAIN step 20/20] loss=0.11133 lr=0.000998 bs=40
2025-09-04 17:17:57 | [EPOCH 6] <<< TRAIN end | loss=0.08796 mem=2830MiB
2025-09-04 17:17:57 | [EPOCH 6] >>> VALID start | steps=5
2025-09-04 17:17:57 | [EPOCH 6] <<< VALID end | loss=0.32228 macro_f1=0.89188
2025-09-04 17:17:57 | [FOLD 3][EPOCH 6] metrics={'fold': 3, 'epoch': 6, 'train_loss': 0.0879605723794099, 'valid_loss': 0.32228014955095424, 'macro_f1': 0.8918785228066051, 'lr': 0.00099778098230154, 'time_s': 4.202035665512085, 'mem_MiB': 2830.10546875}
2025-09-04 17:17:57 | [FOLD 3][EPOCH 6] ----------- end -----------
2025-09-04 17:17:57 | [FOLD 3][EPOCH 7] ---------- start ----------
2025-09-04 17:17:57 | [EPOCH 7] >>> TRAIN start | steps=20
2025-09-04 17:17:58 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:17:58 | [EPOCH 7][TRAIN step 1/20] loss=0.01444 lr=0.000998 bs=64
2025-09-04 17:18:01 | [EPOCH 7][TRAIN step 20/20] loss=0.21355 lr=0.000998 bs=40
2025-09-04 17:18:01 | [EPOCH 7] <<< TRAIN end | loss=0.03592 mem=2830MiB
2025-09-04 17:18:01 | [EPOCH 7] >>> VALID start | steps=5
2025-09-04 17:18:02 | [EPOCH 7] <<< VALID end | loss=0.75621 macro_f1=0.88135
2025-09-04 17:18:02 | [FOLD 3][EPOCH 7] metrics={'fold': 3, 'epoch': 7, 'train_loss': 0.03591987689968887, 'valid_loss': 0.7562101422601445, 'macro_f1': 0.8813457777718855, 'lr': 0.0009969804777275899, 'time_s': 4.339209079742432, 'mem_MiB': 2830.14453125}
2025-09-04 17:18:02 | [FOLD 3][EPOCH 7] ----------- end -----------
2025-09-04 17:18:02 | [FOLD 3][EPOCH 8] ---------- start ----------
2025-09-04 17:18:02 | [EPOCH 8] >>> TRAIN start | steps=20
2025-09-04 17:18:02 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:02 | [EPOCH 8][TRAIN step 1/20] loss=0.00328 lr=0.000997 bs=64
2025-09-04 17:18:07 | [EPOCH 8][TRAIN step 20/20] loss=0.00695 lr=0.000997 bs=40
2025-09-04 17:18:07 | [EPOCH 8] <<< TRAIN end | loss=0.04861 mem=2830MiB
2025-09-04 17:18:07 | [EPOCH 8] >>> VALID start | steps=5
2025-09-04 17:18:08 | [EPOCH 8] <<< VALID end | loss=0.27010 macro_f1=0.93291
2025-09-04 17:18:08 | [FOLD 3][EPOCH 8] metrics={'fold': 3, 'epoch': 8, 'train_loss': 0.04860706028831043, 'valid_loss': 0.27010044882631606, 'macro_f1': 0.9329067861962599, 'lr': 0.000996057350657239, 'time_s': 6.439976453781128, 'mem_MiB': 2830.15625}
2025-09-04 17:18:08 | [FOLD 3][EPOCH 8] NEW_BEST F1=0.93291 -> experiments/train/20250904/v087/ckpt/best_fold3.pth
2025-09-04 17:18:08 | [FOLD 3][EPOCH 8] ----------- end -----------
2025-09-04 17:18:08 | [FOLD 3][EPOCH 9] ---------- start ----------
2025-09-04 17:18:08 | [EPOCH 9] >>> TRAIN start | steps=20
2025-09-04 17:18:09 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:09 | [EPOCH 9][TRAIN step 1/20] loss=0.01562 lr=0.000996 bs=64
2025-09-04 17:18:12 | [EPOCH 9][TRAIN step 20/20] loss=0.00930 lr=0.000996 bs=40
2025-09-04 17:18:12 | [EPOCH 9] <<< TRAIN end | loss=0.04487 mem=2830MiB
2025-09-04 17:18:12 | [EPOCH 9] >>> VALID start | steps=5
2025-09-04 17:18:13 | [EPOCH 9] <<< VALID end | loss=0.37421 macro_f1=0.91299
2025-09-04 17:18:13 | [FOLD 3][EPOCH 9] metrics={'fold': 3, 'epoch': 9, 'train_loss': 0.04487441042378829, 'valid_loss': 0.3742127650102992, 'macro_f1': 0.9129933956429078, 'lr': 0.0009950118288582787, 'time_s': 4.3321452140808105, 'mem_MiB': 2830.1796875}
2025-09-04 17:18:13 | [FOLD 3][EPOCH 9] ----------- end -----------
2025-09-04 17:18:13 | [FOLD 3][EPOCH 10] ---------- start ----------
2025-09-04 17:18:13 | [EPOCH 10] >>> TRAIN start | steps=20
2025-09-04 17:18:13 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:13 | [EPOCH 10][TRAIN step 1/20] loss=0.01311 lr=0.000995 bs=64
2025-09-04 17:18:16 | [EPOCH 10][TRAIN step 20/20] loss=0.00532 lr=0.000995 bs=40
2025-09-04 17:18:16 | [EPOCH 10] <<< TRAIN end | loss=0.03061 mem=2830MiB
2025-09-04 17:18:16 | [EPOCH 10] >>> VALID start | steps=5
2025-09-04 17:18:17 | [EPOCH 10] <<< VALID end | loss=0.31444 macro_f1=0.94375
2025-09-04 17:18:17 | [FOLD 3][EPOCH 10] metrics={'fold': 3, 'epoch': 10, 'train_loss': 0.030609737817720053, 'valid_loss': 0.314444016190661, 'macro_f1': 0.9437487261016673, 'lr': 0.0009938441702975688, 'time_s': 4.164146184921265, 'mem_MiB': 2830.07421875}
2025-09-04 17:18:17 | [FOLD 3][EPOCH 10] NEW_BEST F1=0.94375 -> experiments/train/20250904/v087/ckpt/best_fold3.pth
2025-09-04 17:18:17 | [FOLD 3][EPOCH 10] ----------- end -----------
2025-09-04 17:18:17 | [FOLD 3] <<< end | best_f1=0.94375
2025-09-04 17:18:17 | [FOLD 4] >>> start | train=1256 valid=314
2025-09-04 17:18:17 | [DATA] build loaders | img_dir=/home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/data/raw/train | img_size=384 | bs=64
2025-09-04 17:18:17 | [DATA] dataset sizes | train=1256 valid=314
2025-09-04 17:18:17 | [MODEL] name=efficientnet_b3 pretrained=True pooling=avg params(total/trainable)=10722361/10722361
2025-09-04 17:18:17 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:500: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler(enabled=bool(cfg["train"]["amp"]))
2025-09-04 17:18:17 | [OPTIM] optimizer=Adam, lr=0.001, weight_decay=0.0, scheduler=CosineAnnealingLR
2025-09-04 17:18:17 | [FOLD 4][EPOCH 1] ---------- start ----------
2025-09-04 17:18:17 | [EPOCH 1] >>> TRAIN start | steps=20
2025-09-04 17:18:17 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:18 | [EPOCH 1][TRAIN step 1/20] loss=3.93407 lr=0.001000 bs=64
2025-09-04 17:18:21 | [EPOCH 1][TRAIN step 20/20] loss=0.76010 lr=0.001000 bs=40
2025-09-04 17:18:21 | [EPOCH 1] <<< TRAIN end | loss=0.92615 mem=2847MiB
2025-09-04 17:18:21 | [EPOCH 1] >>> VALID start | steps=5
2025-09-04 17:18:21 | [EPOCH 1] <<< VALID end | loss=0.54364 macro_f1=0.80210
2025-09-04 17:18:21 | [FOLD 4][EPOCH 1] metrics={'fold': 4, 'epoch': 1, 'train_loss': 0.9261457396161025, 'valid_loss': 0.5436375642278392, 'macro_f1': 0.8021047446909838, 'lr': 0.0009999383162408303, 'time_s': 4.184656620025635, 'mem_MiB': 2847.1328125}
2025-09-04 17:18:21 | [FOLD 4][EPOCH 1] NEW_BEST F1=0.80210 -> experiments/train/20250904/v087/ckpt/best_fold4.pth
2025-09-04 17:18:21 | [FOLD 4][EPOCH 1] ----------- end -----------
2025-09-04 17:18:21 | [FOLD 4][EPOCH 2] ---------- start ----------
2025-09-04 17:18:21 | [EPOCH 2] >>> TRAIN start | steps=20
2025-09-04 17:18:22 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:22 | [EPOCH 2][TRAIN step 1/20] loss=0.18688 lr=0.001000 bs=64
2025-09-04 17:18:25 | [EPOCH 2][TRAIN step 20/20] loss=0.12828 lr=0.001000 bs=40
2025-09-04 17:18:25 | [EPOCH 2] <<< TRAIN end | loss=0.22687 mem=2830MiB
2025-09-04 17:18:25 | [EPOCH 2] >>> VALID start | steps=5
2025-09-04 17:18:26 | [EPOCH 2] <<< VALID end | loss=0.45088 macro_f1=0.85150
2025-09-04 17:18:26 | [FOLD 4][EPOCH 2] metrics={'fold': 4, 'epoch': 2, 'train_loss': 0.22686620217979334, 'valid_loss': 0.45087722456379303, 'macro_f1': 0.8514975794557614, 'lr': 0.0009997532801828658, 'time_s': 4.25894570350647, 'mem_MiB': 2830.484375}
2025-09-04 17:18:26 | [FOLD 4][EPOCH 2] NEW_BEST F1=0.85150 -> experiments/train/20250904/v087/ckpt/best_fold4.pth
2025-09-04 17:18:26 | [FOLD 4][EPOCH 2] ----------- end -----------
2025-09-04 17:18:26 | [FOLD 4][EPOCH 3] ---------- start ----------
2025-09-04 17:18:26 | [EPOCH 3] >>> TRAIN start | steps=20
2025-09-04 17:18:26 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:26 | [EPOCH 3][TRAIN step 1/20] loss=0.18944 lr=0.001000 bs=64
2025-09-04 17:18:29 | [EPOCH 3][TRAIN step 20/20] loss=0.04891 lr=0.001000 bs=40
2025-09-04 17:18:29 | [EPOCH 3] <<< TRAIN end | loss=0.14422 mem=2830MiB
2025-09-04 17:18:29 | [EPOCH 3] >>> VALID start | steps=5
2025-09-04 17:18:30 | [EPOCH 3] <<< VALID end | loss=0.49111 macro_f1=0.87496
2025-09-04 17:18:30 | [FOLD 4][EPOCH 3] metrics={'fold': 4, 'epoch': 3, 'train_loss': 0.14422244934519385, 'valid_loss': 0.49110863675737076, 'macro_f1': 0.8749555572692811, 'lr': 0.0009994449374809851, 'time_s': 4.255976915359497, 'mem_MiB': 2830.49609375}
2025-09-04 17:18:30 | [FOLD 4][EPOCH 3] NEW_BEST F1=0.87496 -> experiments/train/20250904/v087/ckpt/best_fold4.pth
2025-09-04 17:18:30 | [FOLD 4][EPOCH 3] ----------- end -----------
2025-09-04 17:18:30 | [FOLD 4][EPOCH 4] ---------- start ----------
2025-09-04 17:18:30 | [EPOCH 4] >>> TRAIN start | steps=20
2025-09-04 17:18:30 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:31 | [EPOCH 4][TRAIN step 1/20] loss=0.02044 lr=0.000999 bs=64
2025-09-04 17:18:34 | [EPOCH 4][TRAIN step 20/20] loss=0.21351 lr=0.000999 bs=40
2025-09-04 17:18:34 | [EPOCH 4] <<< TRAIN end | loss=0.11216 mem=2830MiB
2025-09-04 17:18:34 | [EPOCH 4] >>> VALID start | steps=5
2025-09-04 17:18:35 | [EPOCH 4] <<< VALID end | loss=0.45132 macro_f1=0.86807
2025-09-04 17:18:35 | [FOLD 4][EPOCH 4] metrics={'fold': 4, 'epoch': 4, 'train_loss': 0.11216220753208088, 'valid_loss': 0.45132325466271417, 'macro_f1': 0.8680697740696625, 'lr': 0.0009990133642141358, 'time_s': 4.481661081314087, 'mem_MiB': 2830.4453125}
2025-09-04 17:18:35 | [FOLD 4][EPOCH 4] ----------- end -----------
2025-09-04 17:18:35 | [FOLD 4][EPOCH 5] ---------- start ----------
2025-09-04 17:18:35 | [EPOCH 5] >>> TRAIN start | steps=20
2025-09-04 17:18:35 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:35 | [EPOCH 5][TRAIN step 1/20] loss=0.15324 lr=0.000999 bs=64
2025-09-04 17:18:40 | [EPOCH 5][TRAIN step 20/20] loss=0.06714 lr=0.000999 bs=40
2025-09-04 17:18:40 | [EPOCH 5] <<< TRAIN end | loss=0.06510 mem=2830MiB
2025-09-04 17:18:40 | [EPOCH 5] >>> VALID start | steps=5
2025-09-04 17:18:41 | [EPOCH 5] <<< VALID end | loss=0.32736 macro_f1=0.89516
2025-09-04 17:18:41 | [FOLD 4][EPOCH 5] metrics={'fold': 4, 'epoch': 5, 'train_loss': 0.06509515272963579, 'valid_loss': 0.32736129783521034, 'macro_f1': 0.895164552377415, 'lr': 0.000998458666866564, 'time_s': 6.2795634269714355, 'mem_MiB': 2830.4765625}
2025-09-04 17:18:41 | [FOLD 4][EPOCH 5] NEW_BEST F1=0.89516 -> experiments/train/20250904/v087/ckpt/best_fold4.pth
2025-09-04 17:18:41 | [FOLD 4][EPOCH 5] ----------- end -----------
2025-09-04 17:18:41 | [FOLD 4][EPOCH 6] ---------- start ----------
2025-09-04 17:18:41 | [EPOCH 6] >>> TRAIN start | steps=20
2025-09-04 17:18:41 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:41 | [EPOCH 6][TRAIN step 1/20] loss=0.03208 lr=0.000998 bs=64
2025-09-04 17:18:45 | [EPOCH 6][TRAIN step 20/20] loss=0.00739 lr=0.000998 bs=40
2025-09-04 17:18:45 | [EPOCH 6] <<< TRAIN end | loss=0.05699 mem=2830MiB
2025-09-04 17:18:45 | [EPOCH 6] >>> VALID start | steps=5
2025-09-04 17:18:45 | [EPOCH 6] <<< VALID end | loss=0.47573 macro_f1=0.88486
2025-09-04 17:18:45 | [FOLD 4][EPOCH 6] metrics={'fold': 4, 'epoch': 6, 'train_loss': 0.05698987395817023, 'valid_loss': 0.4757343462318372, 'macro_f1': 0.8848593767731207, 'lr': 0.00099778098230154, 'time_s': 4.40993857383728, 'mem_MiB': 2830.45703125}
2025-09-04 17:18:45 | [FOLD 4][EPOCH 6] ----------- end -----------
2025-09-04 17:18:45 | [FOLD 4][EPOCH 7] ---------- start ----------
2025-09-04 17:18:45 | [EPOCH 7] >>> TRAIN start | steps=20
2025-09-04 17:18:46 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:46 | [EPOCH 7][TRAIN step 1/20] loss=0.01055 lr=0.000998 bs=64
2025-09-04 17:18:49 | [EPOCH 7][TRAIN step 20/20] loss=0.15222 lr=0.000998 bs=40
2025-09-04 17:18:49 | [EPOCH 7] <<< TRAIN end | loss=0.05177 mem=2830MiB
2025-09-04 17:18:49 | [EPOCH 7] >>> VALID start | steps=5
2025-09-04 17:18:50 | [EPOCH 7] <<< VALID end | loss=0.71244 macro_f1=0.85343
2025-09-04 17:18:50 | [FOLD 4][EPOCH 7] metrics={'fold': 4, 'epoch': 7, 'train_loss': 0.05176756175080682, 'valid_loss': 0.7124405514662433, 'macro_f1': 0.8534313287541407, 'lr': 0.0009969804777275899, 'time_s': 4.2508320808410645, 'mem_MiB': 2830.4453125}
2025-09-04 17:18:50 | [FOLD 4][EPOCH 7] ----------- end -----------
2025-09-04 17:18:50 | [FOLD 4][EPOCH 8] ---------- start ----------
2025-09-04 17:18:50 | [EPOCH 8] >>> TRAIN start | steps=20
2025-09-04 17:18:50 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:50 | [EPOCH 8][TRAIN step 1/20] loss=0.09150 lr=0.000997 bs=64
2025-09-04 17:18:53 | [EPOCH 8][TRAIN step 20/20] loss=0.46303 lr=0.000997 bs=40
2025-09-04 17:18:53 | [EPOCH 8] <<< TRAIN end | loss=0.08259 mem=2830MiB
2025-09-04 17:18:53 | [EPOCH 8] >>> VALID start | steps=5
2025-09-04 17:18:54 | [EPOCH 8] <<< VALID end | loss=0.46884 macro_f1=0.89972
2025-09-04 17:18:54 | [FOLD 4][EPOCH 8] metrics={'fold': 4, 'epoch': 8, 'train_loss': 0.08259466214544454, 'valid_loss': 0.46884327310665397, 'macro_f1': 0.899723739682005, 'lr': 0.000996057350657239, 'time_s': 4.1071531772613525, 'mem_MiB': 2830.359375}
2025-09-04 17:18:54 | [FOLD 4][EPOCH 8] NEW_BEST F1=0.89972 -> experiments/train/20250904/v087/ckpt/best_fold4.pth
2025-09-04 17:18:54 | [FOLD 4][EPOCH 8] ----------- end -----------
2025-09-04 17:18:54 | [FOLD 4][EPOCH 9] ---------- start ----------
2025-09-04 17:18:54 | [EPOCH 9] >>> TRAIN start | steps=20
2025-09-04 17:18:54 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:54 | [EPOCH 9][TRAIN step 1/20] loss=0.00505 lr=0.000996 bs=64
2025-09-04 17:18:57 | [EPOCH 9][TRAIN step 20/20] loss=0.00360 lr=0.000996 bs=40
2025-09-04 17:18:57 | [EPOCH 9] <<< TRAIN end | loss=0.03892 mem=2830MiB
2025-09-04 17:18:57 | [EPOCH 9] >>> VALID start | steps=5
2025-09-04 17:18:58 | [EPOCH 9] <<< VALID end | loss=0.57142 macro_f1=0.89513
2025-09-04 17:18:58 | [FOLD 4][EPOCH 9] metrics={'fold': 4, 'epoch': 9, 'train_loss': 0.03891649680763815, 'valid_loss': 0.5714247241900985, 'macro_f1': 0.8951271422795651, 'lr': 0.0009950118288582787, 'time_s': 4.140145778656006, 'mem_MiB': 2830.36328125}
2025-09-04 17:18:58 | [FOLD 4][EPOCH 9] ----------- end -----------
2025-09-04 17:18:58 | [FOLD 4][EPOCH 10] ---------- start ----------
2025-09-04 17:18:58 | [EPOCH 10] >>> TRAIN start | steps=20
2025-09-04 17:18:58 | /home/ieyeppo/AI_Lab/computer-vision-competition-1SEN/src/training/train.py:133: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(enabled=scaler is not None):
2025-09-04 17:18:58 | [EPOCH 10][TRAIN step 1/20] loss=0.00063 lr=0.000995 bs=64
2025-09-04 17:19:01 | [EPOCH 10][TRAIN step 20/20] loss=0.12023 lr=0.000995 bs=40
2025-09-04 17:19:01 | [EPOCH 10] <<< TRAIN end | loss=0.03760 mem=2830MiB
2025-09-04 17:19:01 | [EPOCH 10] >>> VALID start | steps=5
2025-09-04 17:19:02 | [EPOCH 10] <<< VALID end | loss=0.28383 macro_f1=0.93225
2025-09-04 17:19:02 | [FOLD 4][EPOCH 10] metrics={'fold': 4, 'epoch': 10, 'train_loss': 0.03760030172812711, 'valid_loss': 0.283829341363755, 'macro_f1': 0.9322542486949374, 'lr': 0.0009938441702975688, 'time_s': 4.1873321533203125, 'mem_MiB': 2830.41796875}
2025-09-04 17:19:02 | [FOLD 4][EPOCH 10] NEW_BEST F1=0.93225 -> experiments/train/20250904/v087/ckpt/best_fold4.pth
2025-09-04 17:19:02 | [FOLD 4][EPOCH 10] ----------- end -----------
2025-09-04 17:19:02 | [FOLD 4] <<< end | best_f1=0.93225
2025-09-04 17:19:02 | [OOF] macro-F1=0.93455; per-fold=['0.94945', '0.92423', '0.92100', '0.94375', '0.93225']
2025-09-04 17:19:02 | [OOF] saved arrays -> experiments/train/20250904/v087/oof
2025-09-04 17:19:02 | [DONE] all-fold training finished
2025-09-04 17:19:02 | [BOOT] training pipeline finished successfully
2025-09-04 17:19:02 | [EXIT] TRAINING SUCCESS code=0
2025-09-04 17:19:02 | >> Stopping logger and restoring stdio
2025-09-04 17:19:02 | >> 로그 리디렉션 중료.
